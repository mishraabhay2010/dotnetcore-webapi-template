apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: azure-vm-template
  title: Azure VM Template
  description: Template to create an Azure VM for 2 days
spec:
  owner: team-a
  type: service

  parameters:
    - title: VM Configuration
      properties:
        vmName:
          title: VM Name
          type: string
        resourceGroupName:
          title: Resource Group Name
          type: string
        location:
          title: Location
          type: string
          enum:
            - eastus
            - westus
            - westeurope
            - southeastasia
        adminUsername:
          title: Admin Username
          type: string
          ui:field: Secret
        adminPassword:
          title: Admin Password
          type: string
          ui:field: Secret
        osVersion:
          title: OSVersion
          type: string
          enum:
            - win10-22h2-pro
            - win10-22h2-pro-g2
            - 2022-datacenter-azure-edition
            - 2022-datacenter-core-g2
        vmSize:
          title: Virtual Machine Size
          type: string
        enum:
            - Standard_B1s
            - Standard_D2s_v5
  steps:
    - id: fetch-arm-template
      name: Fetch ARM Template
      action: fetch:plain:file
      input:
        url: https://github.com/mishraabhay2010/dotnetcore-webapi-template/blob/main/azure-arm-templates/vmwindow.json
        targetPath: file
    - id: print-working-directory
      name: Print Working Directory
      action: shell:script
      input:
        script: |
          echo "Current Working Directory:"
          pwd
          echo "Environment Variables:"
          env

    - id: list-files
      name: List Files
      action: shell:script
      input:
        script: ls -la file
